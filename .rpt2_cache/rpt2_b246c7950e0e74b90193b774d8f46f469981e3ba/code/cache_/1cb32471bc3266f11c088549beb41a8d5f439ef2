{"code":"import { __assign, __spreadArray } from \"tslib\";\r\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\r\nimport { memo, useEffect, useState } from \"react\";\r\nimport { isEmpty, isNumber } from \"lodash\";\r\nimport { InputTags } from \"components/InputTags\";\r\nimport { ImageItem } from \"components/ImageItem/ImageItem\";\r\nimport { PriceTags } from \"components/Pricetags/PriceTags\";\r\nimport { transformWithKeyMap, transformSuggestionToTag, } from \"utils/transform\";\r\nimport \"Comment/comment.css\";\r\nvar CommentView = function (props) {\r\n    var onDataChange = props.onDataChange, onCommentPriceTagChange = props.onCommentPriceTagChange;\r\n    var _a = useState(props.categoryConfigData), dataTransformCategories = _a[0], setDataTransformCategories = _a[1];\r\n    var _b = useState([]), requestPriceTag = _b[0], setRequestPriceTag = _b[1];\r\n    var _c = useState([]), requestCategories = _c[0], setRequestCategories = _c[1];\r\n    useEffect(function () {\r\n        onDataChange(requestCategories);\r\n    }, [requestCategories]);\r\n    useEffect(function () {\r\n        onCommentPriceTagChange(requestPriceTag);\r\n    }, [requestPriceTag]);\r\n    useEffect(function () {\r\n        if (!isEmpty(props.commentSuggestionResponse) &&\r\n            !isEmpty(props.categoryConfigData)) {\r\n            //Transform data: from suggestion format to tag format\r\n            var keyMapSuggestionToTag = {\r\n                id: \"id\",\r\n                comment: \"name\",\r\n            };\r\n            var suggestionToTags_1 = transformSuggestionToTag(props.commentSuggestionResponse, keyMapSuggestionToTag);\r\n            // Merge suggestion to configure\r\n            var commentWithConfigureAndTags = props.categoryConfigData.map(function (configure) { return (__assign(__assign({}, configure), suggestionToTags_1.find(function (suggestion) { return suggestion.categoryId === configure.categoryId; }))); });\r\n            setDataTransformCategories(commentWithConfigureAndTags);\r\n            // Set default request comment (categoryId and tags)\r\n            var requestCommentTmp_1 = [];\r\n            commentWithConfigureAndTags.forEach(function (category) {\r\n                var categoryTmp = {\r\n                    categoryId: category.categoryId,\r\n                    photos: [],\r\n                    comments: [],\r\n                };\r\n                requestCommentTmp_1.push(categoryTmp);\r\n            });\r\n            setRequestCategories(requestCommentTmp_1);\r\n        }\r\n        else if (!isEmpty(props.categoryConfigData)) {\r\n            // Set default request comment (categoryId and tags)\r\n            var requestCommentTmp_2 = [];\r\n            props.categoryConfigData.forEach(function (categoryConfigItem) {\r\n                var categoryTmp = {\r\n                    categoryId: categoryConfigItem.categoryId,\r\n                    photos: [],\r\n                    comments: [],\r\n                };\r\n                requestCommentTmp_2.push(categoryTmp);\r\n            });\r\n            setRequestCategories(requestCommentTmp_2);\r\n        }\r\n    }, [props.commentSuggestionResponse, props.categoryConfigData]);\r\n    var onHandleChangeTag = function (tags, categoryId) {\r\n        var keyMap = {\r\n            id: \"id\",\r\n            name: \"comment\",\r\n        };\r\n        if (!isEmpty(requestCategories)) {\r\n            var requestCategoriesTmp = __spreadArray([], requestCategories, true);\r\n            var tagsToSuggestion = transformWithKeyMap(tags, keyMap);\r\n            tagsToSuggestion.map(function (item) {\r\n                if (item.id === \"\" || !isNumber(item.id)) {\r\n                    return (item.id = null);\r\n                }\r\n                return item;\r\n            });\r\n            if (categoryId === 28) {\r\n                var tempDataPriceTag_1 = [];\r\n                tagsToSuggestion.map(function (item) {\r\n                    var tempTag = { content: item.comment };\r\n                    tempDataPriceTag_1.push(tempTag);\r\n                });\r\n                setRequestPriceTag(tempDataPriceTag_1);\r\n            }\r\n            requestCategoriesTmp.find(function (item) { return item.categoryId === categoryId; }).comments = tagsToSuggestion;\r\n            setRequestCategories(requestCategoriesTmp);\r\n        }\r\n    };\r\n    var onHandleChangeImage = function (imageList, categoryId) {\r\n        if (!isEmpty(requestCategories)) {\r\n            var requestCategoriesTmp = __spreadArray([], requestCategories, true);\r\n            requestCategoriesTmp.find(function (item) { return item.categoryId === categoryId; }).photos = imageList;\r\n            setRequestCategories(requestCategoriesTmp);\r\n        }\r\n    };\r\n    return (_jsx(\"div\", __assign({ className: \"comment-container\" }, { children: _jsx(\"div\", __assign({ className: \"comment-container__item\" }, { children: dataTransformCategories.map(function (category, index) {\r\n                return category.categoryId === 28 ? (_jsxs(_Fragment, { children: [category.showTextInput && (_jsx(PriceTags, { id: category.categoryId.toString(), showLimit: true, placeholderText: category.placeHolderTextInput, allowChange: true, tags: [], suggestions: category.comments ? category.comments : [], onHandleChange: onHandleChangeTag, noSuggestionsText: \"Kh\\u00F4ng c\\u00F3 d\\u1EEF li\\u1EC7u\", categoryId: category.categoryId, requiredTextInput: category.requiredTextInput, dataTypeTextInput: category.dataTypeTextInput }, void 0)), props.errorsConfig.length > 0 &&\r\n                            props.errorsConfig[index].errorInput && (_jsx(\"p\", __assign({ className: \"title-red\" }, { children: \"Vui l\\u00F2ng nh\\u1EADp n\\u1ED9i dung\" }), void 0))] }, void 0)) : (_jsxs(_Fragment, { children: [_jsx(ImageItem, { onHandleChangeImage: onHandleChangeImage, categoryId: category.categoryId, showPhoto: category.showPhoto, requiredTextInput: category.requiredTextInput, categoryName: category.categoryName }, void 0), props.errorsConfig.length > 0 &&\r\n                            props.errorsConfig[index].errorImage && (_jsx(\"p\", __assign({ className: \"title-red\" }, { children: \"Vui l\\u00F2ng th\\u00EAm h\\u00ECnh \\u1EA3nh\" }), void 0)), category.showTextInput && (_jsx(InputTags, { id: category.categoryId.toString(), showLimit: true, placeholderText: category.placeHolderTextInput, allowChange: true, tags: [], suggestions: category.comments ? category.comments : [], onHandleChange: onHandleChangeTag, noSuggestionsText: \"Kh\\u00F4ng c\\u00F3 d\\u1EEF li\\u1EC7u\", categoryId: category.categoryId, requiredTextInput: category.requiredTextInput, dataTypeTextInput: category.dataTypeTextInput }, void 0)), props.errorsConfig.length > 0 &&\r\n                            props.errorsConfig[index].errorInput && (_jsx(\"p\", __assign({ className: \"title-red\" }, { children: \"Vui l\\u00F2ng nh\\u1EADp n\\u1ED9i dung\" }), void 0))] }, void 0));\r\n            }) }), void 0) }), void 0));\r\n};\r\nexport default memo(CommentView);\r\n//# sourceMappingURL=CommentView.js.map","references":["/Users/tuanbui/projects/client/propzy/clone_comment-category/node_modules/@types/react/index.d.ts","/Users/tuanbui/projects/client/propzy/clone_comment-category/node_modules/@types/lodash/index.d.ts","/Users/tuanbui/projects/client/propzy/clone_comment-category/src/components/InputTags/index.tsx","/Users/tuanbui/projects/client/propzy/clone_comment-category/src/components/ImageItem/ImageItem.tsx","/Users/tuanbui/projects/client/propzy/clone_comment-category/src/components/Pricetags/PriceTags.tsx","/Users/tuanbui/projects/client/propzy/clone_comment-category/src/model/core-model/Config.ts","/Users/tuanbui/projects/client/propzy/clone_comment-category/src/utils/transform.ts","/Users/tuanbui/projects/client/propzy/clone_comment-category/src/modules/Comment/CommentView.d.ts"],"map":"{\"version\":3,\"file\":\"CommentView.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/modules/Comment/CommentView.tsx\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/tuanbui/projects/client/propzy/clone_comment-category/modules/Comment/CommentView.d.ts","writeByteOrderMark":false,"text":"/// <reference types=\"react\" />\r\nimport { CommentProps } from 'modules/Comment/CommentView.d';\r\nimport \"Comment/comment.css\";\r\ndeclare const _default: import(\"react\").NamedExoticComponent<CommentProps>;\r\nexport default _default;\r\n"}}
